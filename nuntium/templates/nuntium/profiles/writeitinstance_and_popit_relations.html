{% extends "base_edit.html" %}
{% load i18n %}
{% load staticfiles %}
{% load pagination_tags %}


{% block extrascripts %}
<link rel="stylesheet" href="{% static 'css/chosen.css' %}">
<script src="{% static 'js/chosen.jquery.min.js' %}"></script>
{% endblock extrascripts %}
{% block extrajs %}
$(".chosen-person-select").chosen();
{% endblock extrajs %}

{% block header %}
{% include 'nuntium/profiles/breadcrumbs.html' with writeitinstance=writeitinstance %}

{% include 'nuntium/profiles/per_instance_top_menu.html' with section='relate-writeit-popit' %}

{% endblock header %}

{% block content %}


<!-- Modal -->
<div class="modal fade" id="relate" >
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">{% trans 'Relate a new PopIt' %}</h4>
      </div>
      <div class="modal-body">
        <form action="{% url 'relate-writeit-popit' slug=writeitinstance.slug %}" method="POST" role="form">
          {% csrf_token %}
          {{ form.as_p }}
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">{% trans 'Close' %}</button>
            <button type="submit" class="btn btn-primary">{% trans 'Submit' %}</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% if messages %}
  <div class="alert alert-info" role="alert">
    {% for message in messages %}
    <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
    {% endfor %}
  </div>
{% endif %}


<div class="tab-content profile-page-tab-content">
  <div class="tab-pane active row" id="instances">

    <div class="col-md-4">
      <button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#relate">
        {% trans 'Relate a new PopIt' %}
      </button>
    </div>
    <div class="col-md-8">
      {% autopaginate relations %}
      {% paginate %}
      <table>
        <thead>
          <tr>
            <th>
              {% trans 'PopIt' %}
            </th>
            <th>
              {% trans 'created' %}
            </th>
            <th>
              {% trans 'updated' %}
            </th>
            <th>
              {% trans 'status' %}
            </th>
            <th>
              {% trans 'notes' %}
            </th>
            <th>
            </th>
          </tr>
        </thead>
        <tbody>
          {% for record in relations %}
            <tr>
              <td>{{ record.popitapiinstance.url }}</td>
              <td>{{ record.created }}</td>
              <td>{{ record.updated }}</td>
              <td>{{ record.status }}</td>
              <td>{{ record.status_explanation }}</td>
            </tr>
          {% endfor %}
        </table>
        {% paginate %}
      </tbody>
    </div>
  </div>

</div>


{% endblock content %}
